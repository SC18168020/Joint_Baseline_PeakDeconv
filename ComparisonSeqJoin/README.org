#+TITLE: Joint versus Sequential Deconvolution

* Supplementary material

This directory contains the [[https://www.wolfram.com/mathematica/][Mathematica]] script used to compare the
joint deconvolution algorithm to the sequential one.

The script [[file:compareScript.wls][compareScript.wls]] is compatible with Mathematica v11. Due
to a complete exploration of possible hyper-parameter values this
computation is quite long (about 4 hours). Hence the saved result is
also available in the [[file:comparisonResult.wl][comparisonResult.wl]] file.

Using this saved file, the plots can be regenerated by:

#+BEGIN_SRC mathematica :evals never
Get["./ComparisonSeqJoin/comparisonResult.wl"];
FormatGlobalResult[comparisonResult["resultSeqcNeg"],comparisonResult["resultJoincNeg"]]  (* convex baseline  *)
FormatGlobalResult[comparisonResult["resultSeqcPos"],comparisonResult["resultJoincPos"]]  (* concave baseline *)
#+END_SRC

The true peaks (deconvolved and convolved with the Gaussian peak shape) are:

[[file:Figures/groundTruthPeaks.png]]

* Convex baseline

** Signal without noise

[[file:Figures/groundTruthPosSp.png]]

** Results

*** Error εe

[[file:Figures/pos_eps.png]]

*** λ1 regularization 

[[file:Figures/pos_lambda1.png]]

*** Sequential algorithm, mSNIP baseline parameter

[[file:Figures/pos_mSNIP.png]]

*** Joint algorithm, μ baseline parameter

[[file:Figures/pos_mu.png]]


* Concave baseline

** Signal without noise

[[file:Figures/groundTruthNegSp.png]]

** Results

*** Error εe

[[file:Figures/neg_eps.png]]

*** λ1 regularization 

[[file:Figures/neg_lambda1.png]]

*** Sequential algorithm, mSNIP baseline parameter

[[file:Figures/neg_mSNIP.png]]

*** Joint algorithm, μ baseline parameter

[[file:Figures/neg_mu.png]]

